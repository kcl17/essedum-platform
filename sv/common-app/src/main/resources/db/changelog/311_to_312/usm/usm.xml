<?xml version="1.1" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog" xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext" xmlns:pro="http://www.liquibase.org/xml/ns/pro" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd http://www.liquibase.org/xml/ns/pro http://www.liquibase.org/xml/ns/pro/liquibase-pro-4.1.xsd http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.1.xsd">
    

    <changeSet author="Essedum" id="3v1-usm-20241204-2" runOnChange="true">  
         <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="1">
                 SELECT COUNT(*) FROM usm_constant WHERE item = 'application.uiconfig.appVersion';
            </sqlCheck>
        </preConditions>
        <sql>
			update usm_constant SET project_name = 'Core', item_value = '3.1.2', project_id=1 where item = 'application.uiconfig.appVersion';
        </sql>
    </changeSet>
    <changeSet author="Essedum" id="3v1-usm-20241209-1">  
         <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="1">
                 SELECT COUNT(*) FROM usm_constant WHERE item = 'application.uiconfig.essedumAppYear';
            </sqlCheck>
        </preConditions>
        <sql>
			UPDATE usm_constant SET project_name = 'Core', item_value='2025', project_id=1
            WHERE item ='application.uiconfig.essedumAppYear';
        </sql>
    </changeSet>

	
		<changeSet author="Essedum (generated)" id="3v1-usm-20241212-1">
		<sql dbms="mssql" splitStatements="true" stripComments="true">
       update usm_constant set item_value  = '{"label":"CI Mgmt","icon":"desktop","horizontal":true,"children":[{"label":"Configuration Item Type","icon":"files-o","url":"./cc/iamp-cfm/cType","children":[]},{"label":"Configuration Item","icon":"file-o","url":"./cc/iamp-cfm/ci","children":[]},{"label":"CI Mapping","icon":"file-text","url":"./cc/iamp-cfm/xwciMapping","children":[]},{"label":"Metrics Master","icon":"file","url":"./cc/metricsMaster","children":[]},{"label":"CI Metrics Mapping","icon":"laptop","url":"./cc/ciMetricsMapping","children":[]},{"label":"CI Dashboard Mapping","icon":"desktop","url":"./cc/ciDashMapping","children":[]}]}'
       where item = 'BCC Admin Side' and project_name= 'Core' and item_value like '%{"label":"CI Mgmt"%';	
    </sql>
	</changeSet>
	
	
	<changeSet id="3v2-usm-2025-15-oct" author="Essedum">
    <preConditions onFail="MARK_RAN">
        <sqlCheck expectedResult="0">
            SELECT COUNT(*) 
            FROM usm_constant 
            WHERE item_value LIKE '%AI Agent%' 
              AND project_id = (SELECT id FROM usm_project WHERE name = 'leo1311') 
              AND item = 'IT Portfolio Manager Side';
        </sqlCheck>
    </preConditions>
    <sql dbms="h2, mysql, mssql, postgresql" splitStatements="true" stripComments="true">
        INSERT INTO usm_constant (
            item, project_name, item_value, project_id, portfolio_id
        ) VALUES (
            'IT Portfolio Manager Side',
            'leo1311',
            '{"label":"AI Agent","altText":null,"icon":"th","url":"./aip/agent","children":[]}',
            (SELECT id FROM usm_project WHERE name = 'leo1311'),
            NULL
        );
    </sql>
</changeSet>

    <changeSet id="3v2-usm-2025-15-oct-core" author="Essedum">
    <preConditions onFail="MARK_RAN">
        <sqlCheck expectedResult="0">
            SELECT COUNT(*) 
            FROM usm_constant 
            WHERE item_value LIKE '%AI Agent%' 
              AND project_id = (SELECT id FROM usm_project WHERE name = 'core') 
              AND item = 'IT Portfolio Manager Side';
        </sqlCheck>
    </preConditions>
    <sql dbms="h2, mysql, mssql, postgresql" splitStatements="true" stripComments="true">
        INSERT INTO usm_constant (
            item, project_name, item_value, project_id, portfolio_id
        ) VALUES (
            'IT Portfolio Manager Side',
            'core',
            '{"label":"AI Agent","altText":null,"icon":"th","url":"./aip/agent","children":[]}',
            (SELECT id FROM usm_project WHERE name = 'core'),
            NULL
        );
    </sql>
</changeSet>
	
</databaseChangeLog>